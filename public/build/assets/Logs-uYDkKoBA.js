import{j as e,H as B,L as v,a as p}from"./app-XWhQqadr.js";import{H as S,A as P,D as E,X as H}from"./app-layout-DK-K0ldS.js";import{C as b,c as k,a as q,b as z,d as V,e as I}from"./card-BC2beU6n.js";import{T as O,a as R,b as _,c as x,d as G,e as o}from"./table-BWDUd_r3.js";import{B as l}from"./badge-wqhiCemZ.js";import{c as h,b as F,B as w}from"./app-logo-icon-B7LppR46.js";import{C as J}from"./chevron-left-COkYFADB.js";import{c as M}from"./index-U8uxxASO.js";import{B as U}from"./bell-DoWIYNzY.js";import{M as C}from"./mail-Bg3WPRrn.js";import{M as D}from"./message-square-BX3kiA4U.js";import{C as W}from"./circle-alert-BwOxeT-v.js";import{E as X}from"./eye-BYplRQSN.js";import{C as K}from"./check-n2-JkkFX.js";/* empty css            */import"./index-C65szwza.js";import"./index-CfglRrGE.js";import"./loader-circle-BlAfInud.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Y=M("ArrowLeft",Q);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ee=M("Send",Z);function te({className:s,...a}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:h("mx-auto flex w-full justify-center",s),...a})}function ae({className:s,...a}){return e.jsx("ul",{"data-slot":"pagination-content",className:h("flex flex-row items-center gap-1",s),...a})}function N({...s}){return e.jsx("li",{"data-slot":"pagination-item",...s})}function y({className:s,isActive:a,size:u="icon",...f}){return e.jsx("a",{"aria-current":a?"page":void 0,"data-slot":"pagination-link","data-active":a,className:h(F({variant:a?"outline":"ghost",size:u}),s),...f})}function se({className:s,...a}){return e.jsxs(y,{"aria-label":"Go to previous page",size:"default",className:h("gap-1 px-2.5 sm:pl-2.5",s),...a,children:[e.jsx(J,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function re({className:s,...a}){return e.jsxs(y,{"aria-label":"Go to next page",size:"default",className:h("gap-1 px-2.5 sm:pr-2.5",s),...a,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(S,{})]})}function ke({observer:s,logs:a}){const u=t=>t?new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"N/A",f=t=>{if(!t)return"Never";const n=new Date(t),m=new Date().getTime()-n.getTime(),c=Math.floor(m/1e3),r=Math.floor(c/60),d=Math.floor(r/60),j=Math.floor(d/24);if(c<60)return"Just now";if(r<60)return`${r} min ago`;if(d<24)return`${d} hour${d!==1?"s":""} ago`;if(j<7)return`${j} day${j!==1?"s":""} ago`;const g=Math.floor(j/7);return g<4?`${g} week${g!==1?"s":""} ago`:u(t)},L=t=>t?e.jsxs(l,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(K,{className:"w-3 h-3 mr-1"}),"Condition Met"]}):e.jsxs(l,{className:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",children:[e.jsx(H,{className:"w-3 h-3 mr-1"}),"No Match"]}),T=(t,n)=>{try{if(!t||!n)return e.jsx(l,{variant:"outline",className:"text-gray-500",children:"Not Sent"});let i=[];if(typeof n=="string")try{i=JSON.parse(n)}catch{i=n.split(",").map(d=>d.trim()).filter(Boolean)}else if(Array.isArray(n))i=n;else return e.jsx(l,{variant:"outline",className:"text-gray-500",children:"Not Sent"});if(!Array.isArray(i)||i.length===0)return e.jsx(l,{variant:"outline",className:"text-gray-500",children:"Not Sent"});const m=i.filter(r=>r&&typeof r=="string"&&r.includes("@")).length,c=i.filter(r=>r&&typeof r=="string"&&!r.includes("@")&&/^\d+$/.test(r)).length;return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs(l,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),"Sent ",f(t)]}),m>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[e.jsx(C,{className:"w-3 h-3"}),m," email",m!==1?"s":""]}),c>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[e.jsx(D,{className:"w-3 h-3"}),c," Telegram",c!==1?"s":""]})]})}catch(i){return console.error("Error rendering notification badge:",i),e.jsx(l,{variant:"outline",className:"text-gray-500",children:"Error"})}},A=t=>t.current_value!==null?e.jsx("div",{className:"font-mono text-sm",children:t.current_value}):t.current_string_value?e.jsxs("div",{className:"max-w-xs truncate text-sm",title:t.current_string_value,children:['"',t.current_string_value,'"']}):e.jsx("span",{className:"text-gray-400 text-sm",children:"N/A"}),$=t=>({less_than:"Less than",greater_than:"Greater than",equals:"Equals",not_equals:"Not equals",contains:"Contains",starts_with:"Starts with",ends_with:"Ends with",date_near_expiry:"Date near expiry",date_expired:"Date expired",date_future:"Future date",date_past:"Past date"})[t]||t.replace("_"," ");return e.jsxs(P,{children:[e.jsx(B,{title:`${s.name} - Logs`}),e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[e.jsx("div",{className:"border-b bg-white dark:bg-black",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(w,{variant:"ghost",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(v,{href:`/value-observers/${s.id}`,children:[e.jsx(Y,{className:"w-4 h-4"}),"Back to Observer"]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900 rounded-lg",children:e.jsx(U,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white",children:[s.name," - Logs"]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Monitoring ",e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:s.field_to_watch})," on"," ",e.jsx("span",{className:"font-medium",children:s.connection_table.table_name})," â€¢"," ",e.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:$(s.condition_type)})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"}),s.has_email_notifications&&e.jsxs(l,{variant:"outline",className:"border-blue-500 text-blue-500",children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),"Email"]}),s.has_telegram_notifications&&e.jsxs(l,{variant:"outline",className:"border-green-500 text-green-500",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),"Telegram"]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(b,{className:"mb-6",children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:a.meta?.total}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Logs"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.data.filter(t=>t.condition_met).length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Conditions Met"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.data.filter(t=>t.notification_sent_to&&t.sent_at).length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Notifications Sent"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-white",children:[e.jsx(E,{className:"w-5 h-5 inline mr-2"}),s.connection_table.connection.name]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Connection"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:s.connection_table.name}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Table"})]})]})})}),e.jsxs(b,{children:[e.jsxs(q,{children:[e.jsx(z,{children:"Activity Logs"}),e.jsxs(V,{children:["Showing ",a.meta?.from," to ",a.meta?.to," of ",a?.meta?.total," logs"]})]}),e.jsx(k,{children:a.data.length>0?e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(O,{children:[e.jsx(R,{children:e.jsxs(_,{children:[e.jsx(x,{children:"Time"}),e.jsx(x,{children:"Record ID"}),e.jsx(x,{children:"Value"}),e.jsx(x,{children:"Condition"}),e.jsx(x,{children:"Notification"}),e.jsx(x,{children:"Details"})]})}),e.jsx(G,{children:a.data.map(t=>e.jsxs(_,{className:"hover:bg-gray-50 dark:hover:bg-gray-900",children:[e.jsx(o,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"font-medium text-sm",children:u(t.created_at)}),e.jsx("div",{className:"text-xs text-gray-500",children:f(t.created_at)})]})}),e.jsx(o,{children:e.jsx("code",{className:"text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:t.record_id})}),e.jsx(o,{children:A(t)}),e.jsx(o,{children:L(t.condition_met)}),e.jsx(o,{children:T(t.sent_at,t.notification_sent_to)}),e.jsx(o,{className:"max-w-xs",children:t.details?e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",title:t.details,children:t.details}):e.jsx("span",{className:"text-gray-400 text-sm",children:"No details"})})]},t.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx(W,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No logs found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"No activity has been recorded for this observer yet"}),e.jsx(w,{asChild:!0,variant:"outline",className:"gap-2",children:e.jsxs(v,{href:`/value-observers/${s.id}`,children:[e.jsx(X,{className:"w-4 h-4"}),"View Observer Details"]})})]})}),a.meta?.last_page>1&&e.jsx(I,{children:e.jsx(te,{children:e.jsxs(ae,{children:[e.jsx(N,{children:e.jsx(se,{href:a.links[0]?.url||"#",onClick:t=>{t.preventDefault(),a.links[0]?.url&&p.get(a.links[0].url)},className:a.links[0]?.url?"":"pointer-events-none opacity-50"})}),a.links.slice(1,-1).map((t,n)=>e.jsx(N,{children:e.jsx(y,{href:"#",onClick:i=>{i.preventDefault(),t.url&&p.get(t.url)},isActive:t.active,children:t.label})},n)),e.jsx(N,{children:e.jsx(re,{href:a.links[a.links.length-1]?.url||"#",onClick:t=>{t.preventDefault(),a.links[a.links.length-1]?.url&&p.get(a.links[a.links.length-1].url)},className:a.links[a.links.length-1]?.url?"":"pointer-events-none opacity-50"})})]})})})]})]})]})]})}export{ke as default};

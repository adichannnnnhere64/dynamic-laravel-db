import{r as v,j as e,H as $,L as c,a as b}from"./app-DeAqZtZ3.js";import{A as B,D,S as E}from"./app-layout-DgaGjPfW.js";import{C as y,c as w,a as L,b as H,d as M}from"./card-kVUHXLHN.js";import{T as O,a as V,b as _,c as a,d as q,e as l}from"./table-CCH9otKR.js";import{B as o}from"./badge-CsmQxwCr.js";import{c as F,B as t}from"./app-logo-icon-B8fPI5Uv.js";import{I as z}from"./input-El65ufWx.js";import{S as P,a as R,b as G,c as J,d as C}from"./select-BWbxT2Ox.js";import{B as S}from"./bell-tnKHOT4h.js";import{P as T}from"./plus-NO3iVm8d.js";import{S as K}from"./search--k5Ytm7V.js";import{C as Q}from"./clock-JqTtKACH.js";import{E as U}from"./eye-D3Y--fXN.js";import{C as W}from"./circle-alert-FkiZYEb1.js";/* empty css            */import"./index-BJC1wku9.js";import"./index-CHvhUF_F.js";import"./index-CSpiwRm-.js";import"./index-BnX7B4NS.js";import"./check-Dz_lJkVu.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Y=F("Filter",X);function Ne({observers:r,connections:k,filters:x}){const[h,m]=v.useState(x.search||""),[j,u]=v.useState(x.connection_id||""),g=()=>{b.get("/value-observers",{search:h||null,connection_id:j||null},{preserveState:!0})},A=s=>{const d={less_than:{label:"Less than",color:"bg-red-100 text-red-800"},greater_than:{label:"Greater than",color:"bg-green-100 text-green-800"},equals:{label:"Equals",color:"bg-blue-100 text-blue-800"},not_equals:{label:"Not equals",color:"bg-yellow-100 text-yellow-800"},contains:{label:"Contains",color:"bg-purple-100 text-purple-800"},starts_with:{label:"Starts with",color:"bg-pink-100 text-pink-800"},ends_with:{label:"Ends with",color:"bg-indigo-100 text-indigo-800"}}[s.condition_type]||{label:s.condition_type,color:"bg-gray-100 text-gray-800"};return e.jsxs(o,{className:d.color,children:[d.label,s.threshold_value!==null&&` ${s.threshold_value}`,s.string_value&&` "${s.string_value}"`]})},p=s=>{if(!s)return"Never";const f=new Date(s),I=new Date().getTime()-f.getTime(),i=Math.floor(I/6e4);if(i<1)return"Just now";if(i<60)return`${i} min ago`;const n=Math.floor(i/60);if(n<24)return`${n} hour${n!==1?"s":""} ago`;const N=Math.floor(n/24);return`${N} day${N!==1?"s":""} ago`};return e.jsxs(B,{children:[e.jsx($,{title:"Value Observers"}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"border-b bg-white",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(S,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Value Observers"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Monitor database values and get alerts"})]})]})}),e.jsx(t,{asChild:!0,children:e.jsxs(c,{href:"/value-observers/create",className:"gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Create Observer"]})})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(y,{className:"mb-6",children:e.jsx(w,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(z,{placeholder:"Search observers...",value:h,onChange:s=>m(s.target.value),onKeyDown:s=>s.key==="Enter"&&g(),className:"pl-10"})]})}),e.jsx("div",{className:"w-full sm:w-64",children:e.jsxs(P,{value:j,onValueChange:u,children:[e.jsx(R,{children:e.jsx(G,{placeholder:"All connections"})}),e.jsxs(J,{children:[e.jsx(C,{value:"all",children:"All connections"})," ",k.filter(s=>s&&s.id&&s.name&&s.name.trim()!=="").map(s=>e.jsx(C,{value:s.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),s.name]})},s.id))]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{onClick:g,variant:"outline",className:"gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"Apply"]}),e.jsx(t,{onClick:()=>{m(""),u(""),b.get("/value-observers")},variant:"ghost",children:"Clear"})]})]})})}),e.jsxs(y,{children:[e.jsxs(L,{children:[e.jsx(H,{children:"Active Observers"}),e.jsxs(M,{children:[r.data.length," observer",r.data.length!==1?"s":""," configured"]})]}),e.jsx(w,{children:r.data.length>0?e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(O,{children:[e.jsx(V,{children:e.jsxs(_,{children:[e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Table & Field"}),e.jsx(a,{children:"Condition"}),e.jsx(a,{children:"Check Interval"}),e.jsx(a,{children:"Last Check"}),e.jsx(a,{children:"Triggers"}),e.jsx(a,{className:"text-right",children:"Actions"})]})}),e.jsx(q,{children:r.data.map(s=>e.jsxs(_,{className:"hover:bg-gray-50",children:[e.jsx(l,{children:e.jsx(o,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsx(l,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-purple-600"}),s.name]})}),e.jsx(l,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.connection_table.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Field: ",e.jsx("code",{children:s.field_to_watch})]}),e.jsx("div",{className:"text-xs text-gray-400",children:s.connection_table.connection.name})]})}),e.jsx(l,{children:A(s)}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4 text-gray-400"}),s.check_interval_minutes," min"]})}),e.jsxs(l,{children:[e.jsx("div",{className:"text-sm",children:p(s.last_checked_at)}),s.last_triggered_at&&e.jsxs("div",{className:"text-xs text-red-600",children:["Last alert: ",p(s.last_triggered_at)]})]}),e.jsx(l,{children:e.jsxs(o,{variant:"outline",children:[s.trigger_count," time",s.trigger_count!==1?"s":""]})}),e.jsx(l,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{size:"sm",variant:"outline",asChild:!0,children:e.jsx(c,{href:`/value-observers/${s.id}`,children:e.jsx(U,{className:"w-3 h-3"})})}),e.jsx(t,{size:"sm",variant:"outline",asChild:!0,children:e.jsx(c,{href:`/value-observers/${s.id}/edit`,children:e.jsx(E,{className:"w-3 h-3"})})})]})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(W,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No observers configured"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first value observer to monitor database fields"}),e.jsx(t,{asChild:!0,children:e.jsxs(c,{href:"/value-observers/create",className:"gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Create Observer"]})})]})})]})]})]})]})}export{Ne as default};

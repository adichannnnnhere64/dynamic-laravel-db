import{r as g,u as Fe,j as e,a as P,L as M}from"./app-DGLSN-Ju.js";import{A as Le,D as z,S as re}from"./app-layout-CNLJJ8vH.js";import{C as B,a as ne,b as ce,d as de,c as G}from"./card--aO_yzBN.js";import{D as $e,a as Ie,b as Pe,c as Me,d as ze,e as He,f as qe}from"./dialog-C27r3mn7.js";import{T as Ke,a as Re,b as oe,c as me,A as Ve,d as Be,e as Ge,f as Oe,g as Qe,h as Ue,i as Ye,j as Ze,k as Je}from"./tabs-DbBtOEeB.js";import{T as We,a as Xe,b as xe,c as _,d as es,e as C}from"./table-CyL6MXQF.js";import{I as D}from"./input-DU2FS2_p.js";import{L as H}from"./label-D2zmhuGz.js";import{c as k,B as p}from"./app-logo-icon-CiKcDI3y.js";import{B as f}from"./badge-D22UW-W-.js";import{S as O,a as Q,b as U,c as Y,d as Z}from"./select-CITfpWsF.js";import{S as he}from"./switch-CJxtLWoX.js";import{t as j,G as E}from"./index-laRRW53S.js";import{C as ss}from"./chevron-left-BRegcnQN.js";import{R as ue}from"./refresh-cw-BwIKu7nN.js";import{S as J}from"./search-2uZY3fCB.js";import{C as as}from"./circle-alert-zn6odLoO.js";import{L as ls}from"./loader-circle-D59Nh1VP.js";import{C as W}from"./check-Bfsx1j1P.js";import{P as pe}from"./plus-477rSdyV.js";import{S as is}from"./square-pen-_pogUT5p.js";import{E as ts}from"./eye-B7afPrBc.js";import{T as rs}from"./trash-2-Dpmh4IXe.js";import{C as q}from"./calendar-DvOvXlIu.js";import{M as ns}from"./mail--z1WOptS.js";/* empty css            */import"./index-BTuH0LaR.js";import"./index-Ct4EE1HF.js";import"./index-CSpiwRm-.js";import"./index-8FkM75eG.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],ds=k("Columns2",cs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],K=k("FileText",os);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],xs=k("Globe",ms);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],fe=k("Hash",hs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],X=k("Key",us);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],fs=k("Shield",ps);function Us({connection:x,actualTables:ee,flash:T}){const[je,v]=g.useState(!1),[y,S]=g.useState(""),[b,F]=g.useState([]),[R,L]=g.useState({}),[u,$]=g.useState(null),[A,I]=g.useState(!1),[ye,ge]=g.useState("configured"),[w,V]=g.useState(""),{data:t,setData:m,post:js,processing:se,errors:N,reset:ae,clearErrors:be}=Fe({table_name:"",name:"",primary_key:"",fields:[],editable_fields:[],input_types:{},is_active:!0,order:x.tables?.length||0});g.useEffect(()=>{T?.success&&j.success(T.success),T?.error&&j.error(T.error)},[T]),g.useEffect(()=>{y&&y!==u?.table_name&&Ne(y)},[y]);const Ne=async s=>{I(!0);try{const a=await fetch(`/api/connection/${x.id}/tables/${s}/columns`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const i=await a.json();if(console.log("API Response for edit:",i),console.log("Editing table input_types:",u?.input_types),i.error)throw new Error(i.error);if(i.columns&&Array.isArray(i.columns)){const r=i.columns.filter(n=>n&&n.trim()!==""),o={};i.types&&Array.isArray(i.types)?r.forEach((n,l)=>{o[n]=i.types[l]||"varchar"}):r.forEach(n=>{o[n]="varchar"}),F(r),L(o);let c={};u?.input_types?(c={...u.input_types},r.forEach(n=>{if(!c[n]){const l=(o[n]||"varchar").toLowerCase();let d="text";l.includes("int")||l.includes("decimal")||l.includes("float")||l.includes("double")?d="number":l.includes("date")?d="date":l.includes("datetime")||l.includes("timestamp")?d="datetime-local":l.includes("time")?d="time":l.includes("text")||l.includes("blob")?d="textarea":l.includes("enum")?d="select":(l.includes("set")||l==="tinyint(1)"||l.includes("boolean"))&&(d="checkbox"),c[n]=d}})):r.forEach(n=>{const l=(o[n]||"varchar").toLowerCase();let d="text";l.includes("int")||l.includes("decimal")||l.includes("float")||l.includes("double")?d="number":l.includes("date")?d="date":l.includes("datetime")||l.includes("timestamp")?d="datetime-local":l.includes("time")?d="time":l.includes("text")||l.includes("blob")?d="textarea":l.includes("enum")?d="select":(l.includes("set")||l==="tinyint(1)"||l.includes("boolean"))&&(d="checkbox"),c[n]=d});const h=u?.primary_key||r[0]||"id";console.log("Final input types to set:",c),m({...t,table_name:s,name:u?.name||s,primary_key:u?.primary_key||h,fields:u?.fields||r,editable_fields:u?.editable_fields||r.filter(n=>n!==h),input_types:c})}else throw new Error("No columns found in response")}catch(a){console.error("Failed to fetch columns:",a),j.error("Connection Error",{description:"Could not fetch table structure from database"})}finally{I(!1)}},ve=s=>{if(s.preventDefault(),be(),!t.table_name){j.error("Please select a table from the database");return}if(!t.name.trim()){j.error("Display name is required");return}if(!t.primary_key){j.error("Primary key is required");return}if(t.fields.includes(t.primary_key)||m("fields",[t.primary_key,...t.fields.filter(o=>o!==t.primary_key)]),t.fields.length===0){j.error("At least one field must be selected");return}const a={...t.input_types};t.fields.forEach(o=>{if(!a[o]){const c=R[o]||"varchar";let h="text";c.includes("int")||c.includes("decimal")||c.includes("float")||c.includes("double")?h="number":c.includes("date")?h="date":c.includes("datetime")||c.includes("timestamp")?h="datetime-local":c.includes("time")?h="time":c.includes("text")||c.includes("blob")?h="textarea":c.includes("enum")?h="select":(c.includes("set")||c==="tinyint(1)"||c.includes("boolean"))&&(h="checkbox"),a[o]=h}}),m("input_types",a);const i=`/connect/${x.id}/tables`;P[u?"put":"post"](i,{...t,input_types:a,id:u?.id},{preserveScroll:!0,onSuccess:()=>{ae(),v(!1),S(""),$(null),F([]),L({})},onError:o=>{console.error("Form errors:",o),j.error("Please check your form for errors")}})},le=async s=>{console.log("Editing table:",s),console.log("Table input_types:",s.input_types),$(s),v(!0),S(s.table_name),m({table_name:s.table_name,name:s.name,primary_key:s.primary_key,fields:s.fields,editable_fields:s.editable_fields||[],input_types:s.input_types||{},is_active:s.is_active,order:s.order}),await we(s.table_name,s.input_types||{})},we=async(s,a)=>{I(!0);try{const i=await fetch(`/api/connection/${x.id}/tables/${s}/columns`);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const r=await i.json();if(console.log("API Response for edit:",r),console.log("Saved input_types:",a),r.error)throw new Error(r.error);if(r.columns&&Array.isArray(r.columns)){const o=r.columns.filter(n=>n&&n.trim()!==""),c={};r.types&&Array.isArray(r.types)?o.forEach((n,l)=>{c[n]=r.types[l]||"varchar"}):o.forEach(n=>{c[n]="varchar"}),F(o),L(c);const h={...a};o.forEach(n=>{if(!h[n]){const l=(c[n]||"varchar").toLowerCase();let d="text";l.includes("int")||l.includes("decimal")||l.includes("float")||l.includes("double")?d="number":l.includes("date")?d="date":l.includes("datetime")||l.includes("timestamp")?d="datetime-local":l.includes("time")?d="time":l.includes("text")||l.includes("blob")?d="textarea":l.includes("enum")?d="select":(l.includes("set")||l==="tinyint(1)"||l.includes("boolean"))&&(d="checkbox"),h[n]=d}}),console.log("Final input types to set:",h),m(n=>({...n,fields:o,input_types:h}))}}catch(i){console.error("Failed to fetch columns:",i),j.error("Connection Error",{description:"Could not fetch table structure from database"})}finally{I(!1)}},_e=s=>{P.delete(`/connect/${x.id}/tables/${s}`,{preserveScroll:!0,onSuccess:()=>{j.success("Table configuration deleted")},onError:()=>{j.error("Could not delete the table configuration")}})},Ce=s=>{const a=t.editable_fields.includes(s)?t.editable_fields.filter(i=>i!==s):[...t.editable_fields,s];m("editable_fields",a)},ke=(s,a)=>{m("input_types",{...t.input_types,[s]:a})},Te=()=>{const s=[t.primary_key].filter(i=>b.includes(i)&&i&&i.trim()!=="");m("fields",s),m("editable_fields",[]);const a={};t.primary_key&&(a[t.primary_key]=t.input_types[t.primary_key]||"text"),m("input_types",a)},Se=s=>{const a=t.fields.includes(s)?t.fields.filter(i=>i!==s):[...t.fields,s];if(m("fields",a),!a.includes(s)){const i=t.editable_fields.filter(o=>o!==s);m("editable_fields",i);const r={...t.input_types};delete r[s],m("input_types",r)}},Ae=()=>{m("fields",b),m("editable_fields",b.filter(s=>s!==t.primary_key))},De=s=>{const a=s.toLowerCase();return a.includes("int")||a.includes("decimal")||a.includes("float")?e.jsx(fe,{className:"w-4 h-4"}):a.includes("date")||a.includes("time")?e.jsx(q,{className:"w-4 h-4"}):a.includes("text")||a.includes("blob")?e.jsx(K,{className:"w-4 h-4"}):a.includes("enum")||a.includes("set")?e.jsx(E,{className:"w-4 h-4"}):a.includes("char")||a.includes("varchar")?e.jsx(M,{className:"w-4 h-4"}):e.jsx(K,{className:"w-4 h-4"})},Ee=()=>[{value:"text",label:"Text",icon:e.jsx(K,{className:"w-4 h-4"})},{value:"number",label:"Number",icon:e.jsx(fe,{className:"w-4 h-4"})},{value:"email",label:"Email",icon:e.jsx(ns,{className:"w-4 h-4"})},{value:"date",label:"Date",icon:e.jsx(q,{className:"w-4 h-4"})},{value:"datetime-local",label:"Date Time",icon:e.jsx(q,{className:"w-4 h-4"})},{value:"time",label:"Time",icon:e.jsx(q,{className:"w-4 h-4"})},{value:"textarea",label:"Text Area",icon:e.jsx(K,{className:"w-4 h-4"})},{value:"select",label:"Dropdown",icon:e.jsx(E,{className:"w-4 h-4"})},{value:"checkbox",label:"Checkbox",icon:e.jsx(W,{className:"w-4 h-4"})},{value:"password",label:"Password",icon:e.jsx(fs,{className:"w-4 h-4"})},{value:"url",label:"URL",icon:e.jsx(M,{className:"w-4 h-4"})}],ie=ee.filter(s=>s.toLowerCase().includes(w.toLowerCase())),te=x.tables?.filter(s=>s.name.toLowerCase().includes(w.toLowerCase())||s.table_name.toLowerCase().includes(w.toLowerCase()))||[];return e.jsx(Le,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[e.jsx("div",{className:"border-b bg-white dark:bg-black",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>P.visit("/connect"),className:"gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),"Back"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(z,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Table Management"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(xs,{className:"w-3 h-3 mr-1"}),x.host,":",x.port]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"font-medium",children:x.database}),e.jsx("span",{children:"•"}),e.jsx("span",{children:x.name})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(p,{variant:"outline",onClick:()=>P.reload({preserveScroll:!0}),className:"gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),"Refresh"]}),e.jsxs($e,{open:je,onOpenChange:v,children:[e.jsx(Ie,{asChild:!0}),e.jsxs(Pe,{className:"max-w-5xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Me,{children:[e.jsxs(ze,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),u?`Edit Table: ${u.name}`:"Configure New Table"]}),e.jsx(He,{children:"Configure how this database table should be displayed and managed in the application"})]}),e.jsxs("form",{onSubmit:ve,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),"Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(H,{htmlFor:"table_name",children:"Database Table *"}),e.jsxs(O,{value:y,onValueChange:S,disabled:!!u,children:[e.jsx(Q,{className:`${N.table_name?"border-red-500":""}`,children:e.jsx(U,{placeholder:"Select a table from database",children:y||"Select a table"})}),e.jsxs(Y,{children:[e.jsx("div",{className:"p-2 border-b",children:e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(D,{placeholder:"Search tables...",value:w,onChange:s=>V(s.target.value),className:"pl-9"})]})}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:ie.filter(s=>s&&s.trim()!=="").map(s=>{const a=x.tables?.some(i=>i.table_name===s);return e.jsx(Z,{value:s,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:s})]}),a&&e.jsx(f,{variant:"outline",className:"text-xs",children:"Configured"})]})},s)})})]})]}),N.table_name&&e.jsx("p",{className:"text-red-500 text-sm",children:N.table_name})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(H,{htmlFor:"name",children:"Display Name *"}),e.jsx(D,{id:"name",value:t.name,onChange:s=>m("name",s.target.value),placeholder:"e.g., Products Inventory",className:N.name?"border-red-500":"",required:!0}),N.name&&e.jsx("p",{className:"text-red-500 text-sm",children:N.name})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(H,{htmlFor:"primary_key",className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4"}),"Primary Key *"]}),e.jsxs(O,{value:t.primary_key,onValueChange:s=>m("primary_key",s),disabled:A||b.length===0,children:[e.jsx(Q,{className:`${N.primary_key?"border-red-500":""}`,children:e.jsx(U,{placeholder:A?"Loading...":b.length===0?"No columns":"Select primary key"})}),e.jsx(Y,{children:b.filter(s=>s&&s.trim()!=="").map(s=>e.jsx(Z,{value:s,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s}),e.jsx(f,{variant:"outline",className:"ml-2 text-xs font-mono",children:R[s]||"varchar"})]})},s))})]}),N.primary_key&&e.jsx("p",{className:"text-red-500 text-sm",children:N.primary_key})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(H,{htmlFor:"order",children:"Display Order"}),e.jsx(D,{id:"order",type:"number",value:t.order,onChange:s=>m("order",parseInt(s.target.value)||0),placeholder:"0"})]})]})]}),A?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(ue,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:"Loading table structure..."}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Fetching columns from ",y]})]})]}):b.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5"}),"Column Configuration",e.jsxs(f,{variant:"outline",className:"ml-2",children:[b.length," columns"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{type:"button",variant:"outline",size:"sm",onClick:Ae,children:"Select All"}),e.jsx(p,{type:"button",variant:"outline",size:"sm",onClick:Te,children:"Deselect All"})]})]}),e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-black px-4 py-3 border-b",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 text-sm font-medium text-gray-700",children:[e.jsx("div",{className:"col-span-1 text-center",children:"Show"}),e.jsx("div",{className:"col-span-3",children:"Column"}),e.jsx("div",{className:"col-span-2",children:"Type"}),e.jsx("div",{className:"col-span-2 text-center",children:"Editable"}),e.jsx("div",{className:"col-span-3",children:"Input Type"}),e.jsx("div",{className:"col-span-1",children:"Properties"})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:b.filter(s=>s&&s.trim()!=="").map(s=>{const a=R[s]||"varchar",i=s===t.primary_key;return e.jsx("div",{className:`px-4 py-3 border-b hover:bg-gray-50 dark:bg-black ${i?"bg-yellow-50":""}`,children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[e.jsx("div",{className:"col-span-1 text-center",children:e.jsx(he,{checked:t.fields.includes(s),onCheckedChange:()=>Se(s)})}),e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[De(a),e.jsx("span",{className:`font-medium ${i?"text-yellow-700":""}`,children:s}),i&&e.jsxs(f,{variant:"secondary",className:"text-xs",children:[e.jsx(X,{className:"w-3 h-3 mr-1"}),"PK"]})]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(f,{variant:"outline",className:"font-mono text-xs",children:a})}),e.jsx("div",{className:"col-span-2 text-center",children:e.jsx(he,{checked:t.editable_fields.includes(s),onCheckedChange:()=>Ce(s),disabled:!t.fields.includes(s)})}),e.jsx("div",{className:"col-span-3",children:e.jsxs(O,{value:t.input_types[s]||"text",onValueChange:r=>ke(s,r),disabled:!t.editable_fields.includes(s),children:[e.jsx(Q,{className:"w-full",children:e.jsx(U,{})}),e.jsx(Y,{children:Ee().map(r=>e.jsx(Z,{value:r.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[r.icon,r.label]})},r.value))})]})}),e.jsx("div",{className:"col-span-1",children:e.jsx("div",{className:"flex justify-end",children:i&&e.jsx(f,{variant:"outline",className:"text-xs",children:"PK"})})})]})},s)})})]})]}):y&&!A?e.jsxs("div",{className:"text-center py-8 border rounded-lg bg-gray-50 dark:bg-black",children:[e.jsx(as,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsxs("p",{className:"text-gray-600",children:['No columns found for table "',y,'"']})]}):null,e.jsxs(qe,{className:"gap-2 pt-4 border-t",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>{v(!1),ae(),$(null),S(""),F([]),L({})},children:"Cancel"}),e.jsx(p,{type:"submit",disabled:se||A,className:"gap-2",children:se?e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):u?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-4 h-4"}),"Update Table"]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"w-4 h-4"}),"Add Table"]})})]})]})]})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs(Ke,{value:ye,onValueChange:ge,className:"space-y-6",children:[e.jsxs(Re,{className:"grid w-full grid-cols-2",children:[e.jsxs(oe,{value:"configured",className:"gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Configured Tables",e.jsx(f,{variant:"secondary",className:"ml-2",children:x.tables?.length||0})]}),e.jsxs(oe,{value:"available",className:"gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Available Tables",e.jsx(f,{variant:"secondary",className:"ml-2",children:ee.length})]})]}),e.jsx(me,{value:"configured",className:"space-y-6",children:e.jsxs(B,{children:[e.jsx(ne,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(ce,{children:"Configured Tables"}),e.jsx(de,{children:"Tables that have been configured for use in the application"})]}),e.jsx("div",{className:"w-full sm:w-64",children:e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(D,{placeholder:"Search tables...",value:w,onChange:s=>V(s.target.value),className:"pl-9"})]})})]})}),e.jsx(G,{children:te.length>0?e.jsx("div",{className:"rounded-md border",children:e.jsxs(We,{children:[e.jsx(Xe,{children:e.jsxs(xe,{children:[e.jsx(_,{children:"Display Name"}),e.jsx(_,{children:"Table Name"}),e.jsx(_,{children:"Primary Key"}),e.jsx(_,{children:"Fields"}),e.jsx(_,{children:"Status"}),e.jsx(_,{className:"text-right",children:"Actions"})]})}),e.jsx(es,{children:te.map(s=>e.jsxs(xe,{children:[e.jsx(C,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-blue-600"}),s.name]})}),e.jsx(C,{children:e.jsx("code",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded text-sm",children:s.table_name})}),e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{children:s.primary_key})]})}),e.jsx(C,{children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.fields.slice(0,3).map(a=>e.jsx(f,{variant:"secondary",className:"text-xs",children:a},a)),s.fields.length>3&&e.jsxs(f,{variant:"outline",className:"text-xs",children:["+",s.fields.length-3," more"]})]})}),e.jsx(C,{children:e.jsx(f,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsx(C,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(p,{size:"sm",variant:"outline",onClick:()=>le(s),children:e.jsx(is,{className:"w-3 h-3"})}),e.jsx(p,{size:"sm",asChild:!0,children:e.jsx(M,{href:`/product?conn=${x.id}&table=${s.id}`,children:e.jsx(ts,{className:"w-3 h-3"})})}),e.jsxs(Ve,{children:[e.jsx(Be,{asChild:!0,children:e.jsx(p,{size:"sm",variant:"destructive",children:e.jsx(rs,{className:"w-3 h-3"})})}),e.jsxs(Ge,{children:[e.jsxs(Oe,{children:[e.jsx(Qe,{children:"Delete Table Configuration"}),e.jsx(Ue,{children:"This will delete the table configuration but won't affect the actual database table."})]}),e.jsxs(Ye,{children:[e.jsx(Ze,{children:"Cancel"}),e.jsx(Je,{onClick:()=>s.id&&_e(s.id),className:"bg-red-600",children:"Delete"})]})]})]})]})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx(z,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No tables configured"}),e.jsxs(p,{onClick:()=>v(!0),className:"gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"Add Your First Table"]})]})})]})}),e.jsx(me,{value:"available",children:e.jsxs(B,{children:[e.jsx(ne,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(ce,{children:"Available Database Tables"}),e.jsx(de,{children:"All tables found in the database"})]}),e.jsx("div",{className:"w-full sm:w-64",children:e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(D,{placeholder:"Search tables...",value:w,onChange:s=>V(s.target.value),className:"pl-9"})]})})]})}),e.jsx(G,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ie.filter(s=>s&&s.trim()!=="").map(s=>{const a=x.tables?.some(r=>r.table_name===s),i=x.tables?.find(r=>r.table_name===s);return e.jsx(B,{children:e.jsxs(G,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded ${a?"bg-green-100":"bg-gray-100 dark:bg-gray-800"}`,children:e.jsx(E,{className:`w-5 h-5 ${a?"text-green-600":"text-gray-600"}`})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s}),i&&e.jsx("p",{className:"text-sm text-gray-600",children:i.name})]})]}),a?e.jsxs(f,{variant:"outline",className:"bg-green-50 text-green-700",children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),"Configured"]}):e.jsx(f,{variant:"outline",children:"Available"})]}),e.jsx("div",{className:"mt-4 flex gap-2",children:a?e.jsxs(e.Fragment,{children:[e.jsx(p,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>i&&le(i),children:"Edit"}),e.jsx(p,{size:"sm",className:"flex-1",asChild:!0,children:e.jsx(M,{href:`/product?conn=${x.id}&table=${i?.id}`,children:"View"})})]}):e.jsx(p,{size:"sm",className:"flex-1",onClick:()=>{S(s),v(!0),$(null)},children:"Configure"})})]})},s)})})})]})})]})})]})})}export{Us as default};

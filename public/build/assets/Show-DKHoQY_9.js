import{j as e,H as p,L as m,a as h}from"./app-DGLSN-Ju.js";import{A as N,D as u}from"./app-layout-CNLJJ8vH.js";import{C as i,a as n,b as l,d as f,c}from"./card--aO_yzBN.js";import{B as d}from"./badge-D22UW-W-.js";import{B as r}from"./app-logo-icon-CiKcDI3y.js";import{C as v}from"./chevron-left-BRegcnQN.js";import{B as y}from"./bell-DycnXRQ5.js";import{R as _}from"./refresh-cw-BwIKu7nN.js";import{S as w}from"./square-pen-_pogUT5p.js";import{C as b}from"./clock-C3owQSEr.js";import{C}from"./calendar-DvOvXlIu.js";import{M as o}from"./mail--z1WOptS.js";import{C as k}from"./circle-alert-zn6odLoO.js";import{T}from"./trash-2-Dpmh4IXe.js";/* empty css            */import"./index-BTuH0LaR.js";import"./index-Ct4EE1HF.js";import"./index-CSpiwRm-.js";function P({observer:s}){const x=t=>t?new Date(t).toLocaleString():"Never",j=()=>{const a={less_than:"Less than",greater_than:"Greater than",equals:"Equals",not_equals:"Not equals",contains:"Contains",starts_with:"Starts with",ends_with:"Ends with"}[s.condition_type]||s.condition_type;return s.threshold_value!==null?`${a} ${s.threshold_value}`:s.string_value?`${a} "${s.string_value}"`:a},g=()=>{confirm("Test this observer now? This will check current values immediately.")&&h.post(`/value-observers/${s.id}/test`)};return e.jsxs(N,{children:[e.jsx(p,{title:s.name}),e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[e.jsx("div",{className:"border-b bg-white dark:bg-black",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>window.history.back(),className:"gap-2",children:[e.jsx(v,{className:"w-4 h-4"}),"Back"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(y,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(d,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Triggers: ",s.trigger_count]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Last check: ",x(s.last_checked_at)]})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(r,{variant:"outline",onClick:g,className:"gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Test Now"]}),e.jsx(r,{variant:"outline",asChild:!0,children:e.jsxs(m,{href:`/value-observers/${s.id}/edit`,className:"gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),"Edit"]})})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsx(l,{children:"Observer Configuration"}),e.jsx(f,{children:"What this observer is monitoring"})]}),e.jsx(c,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Database Connection"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(u,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:s.connection_table.connection.name})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.connection_table.connection.database," @",s.connection_table.connection.host,":",s.connection_table.connection.port]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Table"}),e.jsx("p",{className:"font-medium mt-1",children:s.connection_table.name}),e.jsx("code",{className:"text-sm text-gray-600",children:s.connection_table.table_name})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Field Being Watched"}),e.jsx(d,{variant:"outline",className:"mt-1",children:s.field_to_watch})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Condition"}),e.jsx(d,{className:"mt-1 bg-blue-100 text-blue-800",children:j()})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Check Interval"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(b,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:["Every ",s.check_interval_minutes," minutes"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Last Trigger"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(C,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:x(s.last_triggered_at)})]})]})]})]})})]}),e.jsxs(i,{children:[e.jsx(n,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"w-5 h-5"}),"Notification Settings"]})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Recipients"}),e.jsx("div",{className:"space-y-1",children:s.notification_emails.map((t,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:t})]},a))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Email Subject"}),e.jsx("p",{className:"font-mono text-sm bg-gray-50 dark:bg-black p-2 rounded",children:s.notification_subject})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Email Message"}),e.jsx("div",{className:"font-mono text-sm bg-gray-50 dark:bg-black p-3 rounded whitespace-pre-wrap",children:s.notification_message})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(i,{children:[e.jsx(n,{children:e.jsx(l,{children:"Statistics"})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:s.trigger_count}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Triggers"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold",children:s.logs.filter(t=>t.condition_met).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Conditions Met"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold",children:s.logs.filter(t=>t.notification_sent_to).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Emails Sent"})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Created"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-gray-600",children:"Last Updated"}),e.jsx("span",{children:new Date(s.updated_at).toLocaleDateString()})]})]})})]})})]}),e.jsxs(i,{children:[e.jsx(n,{children:e.jsx(l,{children:"Recent Activity"})}),e.jsxs(c,{children:[s.logs.length>0?e.jsx("div",{className:"space-y-3",children:s.logs.slice(0,5).map(t=>e.jsxs("div",{className:`p-3 rounded border ${t.condition_met?"bg-red-50 border-red-200":"bg-gray-50 dark:bg-black border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.condition_met?e.jsx(k,{className:"w-4 h-4 text-red-600"}):e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-300"}),e.jsxs("span",{className:"text-sm font-medium",children:["Record ",t.record_id]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"mt-2 text-sm",children:["Value: ",t.current_value||t.current_string_value||"N/A"]})]},t.id))}):e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No activity yet"}),s.logs.length>5&&e.jsx(r,{variant:"ghost",size:"sm",className:"w-full mt-3",asChild:!0,children:e.jsx(m,{href:`/value-observers/${s.id}/logs`,children:"View All Activity"})})]})]}),e.jsxs(i,{className:"border-red-200",children:[e.jsx(n,{children:e.jsx(l,{className:"text-red-700",children:"Danger Zone"})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(r,{variant:"destructive",className:"w-full gap-2",onClick:()=>{confirm("Are you sure you want to delete this observer? This action cannot be undone.")&&h.delete(`/value-observers/${s.id}`)},children:[e.jsx(T,{className:"w-4 h-4"}),"Delete Observer"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Deleting this observer will remove all configuration and logs."})]})})]})]})]})})]})]})}export{P as default};
